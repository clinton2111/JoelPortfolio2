angular.module("joelDashBoard.login",[]).controller("loginController",["$scope","Auth","jwtHelper","store","$state","$stateParams","md5",function(e,t,n,r,i,s,o){return s.type==="recovery"&&!_.isUndefined(s.value)&&!_.isUndefined(s.email)?(e.recovery_screen=!0,e.header="Reset Password"):(e.recovery_screen=!1,e.header="Login"),e.forgotPassword=!1,e.viewPass=!1,e.passType="password",e.passIcon="mdi-action-visibility-off",e.toggleShowPassword=function(){return e.viewPass===!1?(e.viewPass=!0,e.passType="text",e.passIcon="mdi-action-visibility"):(e.viewPass=!1,e.passType="password",e.passIcon="mdi-action-visibility-off")},e.login=function(e){var n;return n={email:e.email,password:o.createHash(e.password||"")},t.signIn(n).then(function(e){var t,n;return t=e.data,t.status==="Error"?Materialize.toast(t.message,"4000"):(n={id:t.id,token:t.token,username:t.username,lastUpdate:moment().format("DD-MM-YYYY")},r.set("user",n),Materialize.toast(t.message,"4000"),i.go("dashboard.home"))},function(e){return Materialize.toast(e.data.message,"4000")})["finally"](function(){})},e.recoverPassword=function(e){return console.log(e),t.recoverPassword(e).then(function(e){var t;return t=e.data,console.log(t),Materialize.toast(t.message,4e3)},function(e){return Materialize.toast(e.data.message,4e3)})},e.toggleForgotPass=function(){return e.forgotPassword===!1?(e.forgotPassword=!0,e.header="Recover Password"):(e.forgotPassword=!1,e.header="Login")},e.updatePassword=function(e){var n;return e.password===e.cpassword?(n={password:o.createHash(e.password||""),email:s.email,value:s.value},t.updatePassword(n).then(function(e){var t;return t=e.data,Materialize.toast(t.status+" - "+t.message,4e3),i.go("auth",{type:"login",email:null,value:null})},function(e){return Materialize.toast("Opps something went wrong",4e3)})):Materialize.toast("Passwords do not match",4e3)}}]);