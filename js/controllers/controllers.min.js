angular.module("joelPortfolio").controller("MainController",["$scope","$q","$timeout","mainServices","API",function(e,t,n,r,i){var s,o;return o=function(){var t;return $(".button-collapse").sideNav(),$(".parallax").parallax(),t={zoom:16,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:[{featureType:"all",stylers:[{saturation:0},{hue:"#e7ecf0"}]},{featureType:"road",stylers:[{saturation:-70}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{visibility:"simplified"},{saturation:-60}]}]},e.map=new google.maps.Map(document.getElementById("map-canvas"),t)},e.gigs=[],e.photos=[],s=[],e.picUrl={photo:i.url+"../../assets/images/photos/",gig:i.url+"../../assets/images/gigs/"},e.$on("$viewContentLoaded",o),$(window).scroll(function(){var e,t,n;return t=$(this).scrollTop(),n=$(this).height(),e=150,$("section").each(function(){var r;return r=$(this).position().top,t+n>=r+e?$(this).stop().animate({opacity:1,marginTop:10},"fast"):$(this).stop().animate({opacity:0,marginTop:0},"fast")})}),e.fetchGigs=function(t){return t==null&&(t=0),e.loadingGigs=!0,r.getGigs(t).then(function(t){var n;return n=t.data,_.each(n.results,function(t){return e.gigs.push(t)})},function(e){return console.log(e)})["finally"](function(){return e.loadingGigs=!1})},e.fetchPhotos=function(t){return t==null&&(t=0),e.loadingPhotos=!0,r.getPics(t).then(function(t){var n;return n=t.data,n=t.data,_.each(n.results,function(t){return e.photos.push(t)})},function(e){return console.log(e)})["finally"](function(){return e.loadingPhotos=!1})},e.getGigInfo=function(t){var n,r,i,o,u,a;return i=_.findIndex(e.gigs,{id:t}),n=e.gigs[i],e.gigInfo={id:t,title:n.title,address:n.address,date:n.event_date,fbLink:n.fb_link,lat:n.latitude,lng:n.longitude,image:n.photo_image},s.length>0&&(s[0].setMap(null),s=[]),u=new google.maps.LatLng(Number(n.latitude),Number(n.longitude)),o=new google.maps.InfoWindow,r={url:"../assets/icons/map_pointer.svg",origin:new google.maps.Point(0,0)},a=new google.maps.Marker({map:e.map,position:u,icon:r}),google.maps.event.addListener(a,"mouseover",function(){return o.setContent(n.title+" - "+n.address),o.open(e.map,this),a.setMap(e.map)}),google.maps.event.addListener(a,"mouseout",function(){}),o.close(),$("#gigInfo").openModal(),google.maps.event.trigger(e.map,"resize"),e.map.setCenter(u),s.push(a)},e.sendEmail=function(){return r.sendEmail(e.email).then(function(e){var t;return t=e.data,t.status==="Success"?Materialize.toast(t.status+" - "+t.message,4e3):Materialize.toast(t.status+" - "+t.message,4e3)},function(e){return Materialize.toast("Opps something went wrong.",4e3)})},e.loadMoreGigs=function(){var t;return t=e.gigs[e.gigs.length-1].id,r.getGigs(t).then(function(t){var n;return n=t.data,n.status==="Success"?_.each(n.results,function(t){return e.gigs.push(t)}):Materialize.toast(n.message,4e3)},function(e){return console.log(e)})},e.loadMorePhotos=function(){var t;return t=e.photos[e.photos.length-1].id,r.getPics(t).then(function(t){var n;return n=t.data,n.status==="Success"?_.each(n.results,function(t){return e.photos.push(t)}):Materialize.toast(n.message,4e3)},function(e){return console.log(e)})},e.$watchCollection(["photos","gigs","loadingPhotos","loadingGigs"],function(){return e.$apply},!1)}]);